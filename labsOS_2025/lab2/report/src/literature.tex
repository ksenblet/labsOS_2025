\section{Исходная программа}

{\bfseries matrix.h} 

\begin{lstlisting}[language=C++]
#ifndef MATRIX_H
#define MATRIX_H

#include <vector>

class Matrix {
public:
    Matrix();
    Matrix(int rows, int cols);
    
    int getRows() const;
    int getCols() const;
    int getValue(int row, int col) const;
    void setValue(int row, int col, int value);
    
    void print() const;
    void fillFromConsole();
    
    int applyMedianFilter(int row, int col, int windowSize, const Matrix& source) const;

private:
    std::vector<std::vector<int>> data;
    int rows;
    int cols;
};

#endif
\end{lstlisting}

{\bfseries matrix.cpp} 

\begin{lstlisting}[language=C++]
#include <algorithm>
#include <iostream>
#include <stdexcept>

#include "matrix.h"

Matrix::Matrix() : rows(0), cols(0) {}

Matrix::Matrix(int rows, int cols) : rows(rows), cols(cols) {
    data.resize(rows, std::vector<int>(cols, 0));
}

int Matrix::getRows() const { 
    return rows; 
}

int Matrix::getCols() const { 
    return cols; 
}

int Matrix::getValue(int row, int col) const {
    if (row >= 0 && row < rows && col >= 0 && col < cols) {
        return data[row][col];
    }
    return 0;
}

void Matrix::setValue(int row, int col, int value) {
    if (row >= 0 && row < rows && col >= 0 && col < cols) {
        data[row][col] = value;
    }
}

void Matrix::print() const {
    std::cout << "Matrix " << rows << "x" << cols << ":" << std::endl;
    for (int i = 0; i < rows; ++i) {
        for (int j = 0; j < cols; ++j) {
            std::cout << data[i][j] << "\t";
        }
        std::cout << std::endl;
    }
}

void Matrix::fillFromConsole() {
    std::cout << "input the number of rows: ";
    std::cin >> rows;
    std::cout << "input the number of cols: ";
    std::cin >> cols;
    
    if (rows <= 0 || cols <= 0) {
        throw std::invalid_argument("input positive values for rows and cols for matrix");
    }
    
    data.resize(rows, std::vector<int>(cols));
    
    std::cout << "Input the matrix elements separated by a space:" << std::endl;
    for (int i = 0; i < rows; ++i) {
        for (int j = 0; j < cols; ++j) {
            std::cin >> data[i][j];
        }
    }
}

int Matrix::applyMedianFilter(int row, int col, int windowSize, const Matrix& source) const {
    if (windowSize % 2 == 0) {
        throw std::invalid_argument("Window size must be odd(for example(1, 3, 5, etc))");
    }
    
    int halfWindow = windowSize / 2;
    std::vector<int> windowValues;
    
    // Собираем значения из окна
    for (int i = -halfWindow; i <= halfWindow; ++i) {
        for (int j = -halfWindow; j <= halfWindow; ++j) {
            int currentRow = row + i;
            int currentCol = col + j;
            
            if (currentRow >= 0 && currentRow < source.getRows() && 
                currentCol >= 0 && currentCol < source.getCols()) {
                windowValues.push_back(source.getValue(currentRow, currentCol));
            }
        }
    }
    
    // Сортируем и находим медиану
    if (windowValues.empty()) {
        return 0;
    }
    
    std::sort(windowValues.begin(), windowValues.end());
    return windowValues[windowValues.size() / 2];
}
\end{lstlisting}

{\bfseries threads.h} 

\begin{lstlisting}[language=C++]
#ifndef THREADS_H
#define THREADS_H

#include <vector>
#include <windows.h>

#include "matrix.h"

typedef HANDLE ThreadHandle;

int threadCreate(ThreadHandle* handle, void* (*threadFunction)(void*), void* threadArgument);
void threadJoin(ThreadHandle handle);
void* processMatrixRegion(void* argument);  // static чтобы можно было использовать как callback
    

// класс семафора для синхронизации доступа к общим ресурсам
class Semaphore {
public:
    Semaphore(int initialCount);
    ~Semaphore();
    void wait();
    void signal();

private:
    HANDLE semaphore;  // дескриптор системного семафора Windows
};

// структура для передачи данных в рабочий поток
struct ThreadData {
    const Matrix* inputMatrix;    // указатель на входную матрицу (только для чтения)
    Matrix* outputMatrix;         // указатель на выходную матрицу (для записи)
    int windowSize;               // размер окна для медианного фильтра
    int threadId;                 // уникальный идентификатор потока (для отладки)
    int iterations;               // количество применений фильтра (K)
    
    // общие ресурсы для синхронизации между потоками
    Semaphore* matrixSemaphore;   // семафор для защиты доступа к общим данным
    int* nextRow;                 // указатель на общий счетчик текущей строки
    int totalRows;                // общее количество строк в матрице
};

// класс для управления созданием и синхронизацией потоков
class ThreadControl {
public:
    ThreadControl(int maxThreads);
    ~ThreadControl();

    // Основной метод применения медианного фильтра в многопоточном режиме
    bool applyMedianFilter(const Matrix& input, Matrix& output, int windowSize, int iterations);

private:
    std::vector<ThreadHandle> threads;      // Вектор дескрипторов созданных потоков
    std::vector<ThreadData*> threadData;    // Вектор структур данных для потоков
    int maxThreads;                         // Максимальное количество потоков
    
    // Общие ресурсы, защищаемые семафором
    Semaphore* matrixSemaphore;             // Семафор для синхронизации доступа к матрице
    int nextRow;                            // Текущая строка для обработки (общий ресурс)
    int totalRows;                          // Общее количество строк в матрице
};

#endif
\end{lstlisting}

{\bfseries threads.cpp} 

\begin{lstlisting}[language=C++]
#include <iostream>
#include <vector>

#include "threads.h"

Semaphore::Semaphore(int initialCount) {
    // NULL - атрибуты безопасности по умолчанию
    // initialCount - начальное значение счетчика разрешений
    // initialCount - макс значение
    // NULL - семафор без имени
    semaphore = CreateSemaphore(NULL, initialCount, initialCount, NULL);
}

Semaphore::~Semaphore() {
    CloseHandle(semaphore);
}

// блокирует поток если счетчик = 0
void Semaphore::wait() {
    WaitForSingleObject(semaphore, INFINITE); // INFINITE - бесконечное ожидание
}

// счетчик разрешений + 1
void Semaphore::signal() {
    // 1 - на сколько +
    // NULL - не важно предыдущее значение счетчика
    ReleaseSemaphore(semaphore, 1, NULL);
}

int ThreadCreate(ThreadHandle* handle, void* (*threadFunction)(void*), void* threadArgument) {
    // nullptr - атрибуты безопасности по умолчанию
    // 0 - размер стека по умолчанию
    // (LPTHREAD_START_ROUTINE)threadFunction - функция, которую будет выполнять поток
    // threadArgument - аргумент для функции потока
    // 0 - флаги создания (0 = выполнение сразу после создания)
    // nullptr - не сохраняем идентификатор потока
    *handle = CreateThread(nullptr, 0, (LPTHREAD_START_ROUTINE)threadFunction, 
                          threadArgument, 0, nullptr);
    if (*handle == NULL) 
    {
        std::cerr << "ERROR: CreateThread failed:(" << std::endl;
        return -1;
    }
    return 0;
}

void ThreadJoin(ThreadHandle handle) {
    // WaitForSingleObject блокирует текущий поток до завершения указанного
    WaitForSingleObject(handle, INFINITE);
    CloseHandle(handle); // handle - дескриптор потока, которого ждем
}

void* ProcessMatrixRegion(void* argument) {
    ThreadData* data = static_cast<ThreadData*>(argument);

    // для проверки количества потоков через диспетчер задач
    std::cout << "Check Task Manager NOW to see threads! You have 30 seconds!" << std::endl;
    Sleep(30000);

    // обрабатываем указанное количество итераций
    for (int i = 0; i < data->iterations; ++i) {
        // Обрабатываем строки пока они не закончатся
        bool workRemaining = true;
        while (workRemaining) {
            int currentRow = -1;  // номер текущей обрабатываемой стр
            // захватываем семафор
            data->matrixSemaphore->wait();
            // остались ли строки для обработки
            if (*data->nextRow < data->totalRows) {
                // след строка и счетчик + 1
                currentRow = (*data->nextRow);
                (*data->nextRow)++;
            } else {
                workRemaining = false;
            }
            // свобода семафору
            data->matrixSemaphore->signal();

            if (currentRow != -1) {
                for (int col = 0; col < data->inputMatrix->getCols(); ++col) {
                    int filteredValue = data->inputMatrix->applyMedianFilter(currentRow, col, data->windowSize, *(data->inputMatrix));
                    data->outputMatrix->setValue(currentRow, col, filteredValue);
                }
            }
        }
        // сброс счетчика строк для след итерации
        if (i < data->iterations - 1) {
            data->matrixSemaphore->wait();
            *data->nextRow = 0;  // сброс только если будут еще итерации
            data->matrixSemaphore->signal();
        }
    }
    return nullptr;
}

ThreadControl::ThreadControl(int maxThreads) 
    : maxThreads(maxThreads), nextRow(0), totalRows(0) {
    // семафор с 1 разрешением
    // только 1 поток может одновременно изменять общие данные!!
    matrixSemaphore = new Semaphore(1);
}

ThreadControl::~ThreadControl() {
    for (auto data : threadData) {
        delete data;
    }
    delete matrixSemaphore;
}

bool ThreadControl::applyMedianFilter(const Matrix& input, Matrix& output, int windowSize, int iterations) {
    totalRows = input.getRows();
    
    for (auto data : threadData) {
        delete data;
    }
    threadData.clear();
    
    for (auto handle : threads) {
        if (handle) {
            CloseHandle(handle);
        }
    }
    threads.clear();
    
    // сброс счетчика стр для новой обработки
    nextRow = 0;

    for (int i = 0; i < maxThreads; ++i) {
        ThreadData* data = new ThreadData;
        data->inputMatrix = &input;
        data->outputMatrix = &output;
        data->windowSize = windowSize;
        data->threadId = i + 1;  // нумерация потоков с 1
        data->iterations = iterations;
        data->matrixSemaphore = matrixSemaphore;
        data->nextRow = &nextRow;
        data->totalRows = totalRows;
        
        threadData.push_back(data); // сохраняем указатель для последующего удаления

        ThreadHandle threadHandle;
        int createResult = ThreadCreate(&threadHandle, ProcessMatrixRegion, data);
        if (createResult != 0) {
            std::cerr << "Error: failed to create thread " << i << std::endl;
            return false; 
        }
        
        // дескриптор созданного потока
        threads.push_back(threadHandle);
    }
    
    for (auto handle : threads) {
        ThreadJoin(handle);
    }
    
    return true;
}
\end{lstlisting}

{\bfseries main.cpp} 

\begin{lstlisting}[language=C++]
#include <iostream>
#include <string>
#include <windows.h>

#include "matrix.h"
#include "threads.h"

void printUsage() {
    std::cout << "Usage: median_filter.exe -threads N" << std::endl;  // Использование: median_filter.exe -threads N
    std::cout << "  -threads N : maximum number of threads (required parameter)" << std::endl;  // максимальное количество потоков (обязательный параметр)
    std::cout << std::endl;
    std::cout << "Example: median_filter.exe -threads 4" << std::endl;  // Пример: median_filter.exe -threads 4
}

int main(int argc, char* argv[]) {
    // Парсинг аргументов командной строки - ТОЛЬКО threads
    int maxThreads = 0;
    
    std::cout << "=== Matrix Median Filter ===" << std::endl;  // Медианный фильтр для матрицы
    std::cout << "Laboratory work on thread management" << std::endl;  // Лабораторная работа по управлению потоками
    std::cout << "=====================================" << std::endl;
    
    // Проверяем аргументы командной строки
    for (int i = 1; i < argc; ++i) {
        std::string arg = argv[i];
        if (arg == "-threads" && i + 1 < argc) {
            try {
                maxThreads = std::stoi(argv[++i]);
                if (maxThreads <= 0) {
                    std::cerr << "Error: number of threads must be positive" << std::endl;  // Ошибка: количество потоков должно быть положительным числом
                    return 1;
                }
            } catch (const std::exception& e) {
                std::cerr << "Error: invalid thread count format" << std::endl;  // Ошибка: неверный формат числа потоков
                return 1;
            }
        }
    }
    
    // Проверка обязательного параметра
    if (maxThreads <= 0) {
        std::cerr << "Error: must specify number of threads" << std::endl;  // Ошибка: необходимо указать количество потоков
        printUsage();
        return 1;
    }
    
    std::cout << "Set maximum number of threads: " << maxThreads << std::endl;  // Задано максимальное количество потоков
    
    try {
        // Ввод матрицы
        Matrix input;
        input.fillFromConsole();
        
        // Ввод параметров фильтра
        int windowSize, iterations;
        
        std::cout << "Enter window size for median filter (odd number): ";  // Введите размер окна для медианного фильтра (нечетное число)
        std::cin >> windowSize;
        
        if (windowSize % 2 == 0 || windowSize <= 0) {
            std::cerr << "Error: window size must be positive odd number!" << std::endl;  // Ошибка: размер окна должен быть положительным нечетным числом!
            return 1;
        }
        
        std::cout << "Enter number of filter applications (K): ";  // Введите количество применений фильтра (K)
        std::cin >> iterations;
        
        if (iterations <= 0) {
            std::cerr << "Error: number of iterations must be positive!" << std::endl;  // Ошибка: количество итераций должно быть положительным!
            return 1;
        }
        
        // Вывод исходной матрицы
        std::cout << "\n--- Original Matrix ---" << std::endl;  // Исходная матрица
        input.print();
        
        // Создание выходной матрицы
        Matrix output(input.getRows(), input.getCols());
        
        // Создание менеджера потоков и применение фильтра
        ThreadControl threadManager(maxThreads);
        
        std::cout << "\n--- Processing ---" << std::endl;  // Обработка
        std::cout << "Processing parameters:" << std::endl;  // Параметры обработки
        std::cout << " - Maximum threads: " << maxThreads << std::endl;  // Максимальное количество потоков
        std::cout << " - Window size: " << windowSize << std::endl;  // Размер окна
        std::cout << " - Iterations: " << iterations << std::endl;  // Количество итераций
        std::cout << " - Matrix size: " << input.getRows() << " x " << input.getCols() << std::endl;  // Размер матрицы
        
        bool success = threadManager.applyMedianFilter(input, output, windowSize, iterations);
        
        if (!success) {
            std::cerr << "Error applying filter!" << std::endl;  // Ошибка применения фильтра!
            return 1;
        }
        
        std::cout << "\n--- Result ---" << std::endl;  // Результат
        std::cout << "Processing completed successfully!" << std::endl;  // Обработка завершена успешно!
        
        // Вывод результирующей матрицы
        std::cout << "\nResult matrix:" << std::endl;  // Результирующая матрица
        output.print();
        
    } catch (const std::exception& e) {
        std::cerr << "Error: " << e.what() << std::endl;  // Ошибка
        return 1;
    }
    return 0;
}
\end{lstlisting}

{\bfseries Process Monitor} 

\begin{lstlisting}
"Time of Day","Process Name","PID","Operation","Path","Result","Detail"
"16:19:56,7461313","median_filter.exe","18224","Process Start","","SUCCESS","Parent PID: 6700, Command line: ""C:\Users\kseni\lab2_OS_wind\build\median_filter.exe"" -threads 4, Current directory: C:\Users\kseni\lab2_OS_wind\build\, Environment: 
;	ALLUSERSPROFILE=C:\ProgramData
;	APPDATA=C:\Users\kseni\AppData\Roaming
;	CC=C:/Users/kseni/gcc/bin/gcc.exe
;	CHROME_CRASHPAD_PIPE_NAME=\\.\pipe\crashpad_2504_XPWAWQPABAGGVPJE
;	CommonProgramFiles=C:\Program Files\Common Files
;	CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files
;	CommonProgramW6432=C:\Program Files\Common Files
;	COMPUTERNAME=LAPTOP-ECH40E5U
;	ComSpec=C:\Windows\system32\cmd.exe
;	CXX=C:/Users/kseni/gcc/bin/g++.exe
;	DriverData=C:\Windows\System32\Drivers\DriverData
;	EFC_5084=1
;	HOMEDRIVE=C:
;	HOMEPATH=\Users\kseni
;	JAVA_HOME=C:\Program Files\Zulu\zulu-17\
;	LOCALAPPDATA=C:\Users\kseni\AppData\Local
;	LOGONSERVER=\\LAPTOP-ECH40E5U
;	NUMBER_OF_PROCESSORS=8
;	OneDrive=C:\Users\kseni\OneDrive
;	OneDriveConsumer=C:\Users\kseni\OneDrive
;	ORIGINAL_XDG_CURRENT_DESKTOP=undefined
;	OS=Windows_NT
;	Path=D:\Program Files\VMware\VMware Workstation\bin\;%PATH%;C:/Users/kseni/gcc/bin;C:\Program Files\swipl\bin;C:\Program Files\Git\bin;D:\Program Files\VMware\VMware Workstation\bin\;%PATH%;C:/Users/kseni/gcc/bin;C:\Program Files\swipl\bin;C:/Users/kseni/gcc/bin;;C:\Users\kseni\AppData\Local\Programs\Microsoft VS Code\bin
;	PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL
;	PROCESSOR_ARCHITECTURE=AMD64
;	PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 140 Stepping 2, GenuineIntel
;	PROCESSOR_LEVEL=6
;	PROCESSOR_REVISION=8c02
;	ProgramData=C:\ProgramData
;	ProgramFiles=C:\Program Files
;	ProgramFiles(x86)=C:\Program Files (x86)
;	ProgramW6432=C:\Program Files
;	PSModulePath=C:\Users\kseni\OneDrive\Документы\WindowsPowerShell\Modules;C:\Program Files\WindowsPowerShell\Modules;C:\Windows\system32\WindowsPowerShell\v1.0\Modules
;	PUBLIC=C:\Users\Public
;	PyCharm Community Edition=C:\Program Files\JetBrains\PyCharm Community Edition 2023.3.3\bin;
;	SESSIONNAME=Console
;	SystemDrive=C:
;	SystemRoot=C:\Windows
;	TEMP=C:\Users\kseni\AppData\Local\Temp
;	TMP=C:\Users\kseni\AppData\Local\Temp
;	USERDOMAIN=LAPTOP-ECH40E5U
;	USERDOMAIN_ROAMINGPROFILE=LAPTOP-ECH40E5U
;	USERNAME=kseni
;	USERPROFILE=C:\Users\kseni
;	windir=C:\Windows
;	ZES_ENABLE_SYSMAN=1
;	TERM_PROGRAM=vscode
;	TERM_PROGRAM_VERSION=1.105.1
;	LANG=en_US.UTF-8
;	COLORTERM=truecolor
;	GIT_ASKPASS=c:\Users\kseni\AppData\Local\Programs\Microsoft VS Code\resources\app\extensions\git\dist\askpass.sh
;	VSCODE_GIT_ASKPASS_NODE=C:\Users\kseni\AppData\Local\Programs\Microsoft VS Code\Code.exe
;	VSCODE_GIT_ASKPASS_EXTRA_ARGS=
;	VSCODE_GIT_ASKPASS_MAIN=c:\Users\kseni\AppData\Local\Programs\Microsoft VS Code\resources\app\extensions\git\dist\askpass-main.js
;	VSCODE_GIT_IPC_HANDLE=\\.\pipe\vscode-git-9312ad4627-sock
;	VSCODE_INJECTION=1
;	VSCODE_NONCE=97d056a9-2719-4738-931e-d88815357e97
;	VSCODE_A11Y_MODE=0
;	VSCODE_STABLE=1"
"16:19:56,7461648","median_filter.exe","18224","Thread Create","","SUCCESS","Thread ID: 4944"
"16:19:56,7485438","median_filter.exe","18224","Load Image","C:\Users\kseni\lab2_OS_wind\build\median_filter.exe","SUCCESS","Image Base: 0x7ff747ff0000, Image Size: 0xd7a000"
"16:19:56,7486411","median_filter.exe","18224","Load Image","C:\Windows\System32\ntdll.dll","SUCCESS","Image Base: 0x7ff88dd10000, Image Size: 0x217000"
"16:19:56,7488158","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Nls\CodePage","REPARSE","Desired Access: Read"
"16:19:56,7488346","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Nls\CodePage","SUCCESS","Desired Access: Read"
"16:19:56,7488540","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Nls\CodePage\ACP","SUCCESS","Type: REG_SZ, Length: 10, Data: 1251"
"16:19:56,7488729","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Nls\CodePage\OEMCP","SUCCESS","Type: REG_SZ, Length: 8, Data: 866"
"16:19:56,7488873","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Nls\CodePage","SUCCESS",""
"16:19:56,7490000","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Session Manager","REPARSE","Desired Access: Query Value"
"16:19:56,7490169","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS","Desired Access: Query Value"
"16:19:56,7490333","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\RaiseExceptionOnPossibleDeadlock","NAME NOT FOUND","Length: 80"
"16:19:56,7490485","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS",""
"16:19:56,7490627","median_filter.exe","18224","RegOpenKey","HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Segment Heap","REPARSE","Desired Access: Query Value"
"16:19:56,7490863","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Session Manager\Segment Heap","NAME NOT FOUND","Desired Access: Query Value"
"16:19:56,7491304","median_filter.exe","18224","RegOpenKey","HKLM\SYSTEM\CurrentControlSet\Control\Session Manager","REPARSE","Desired Access: Query Value, Enumerate Sub Keys"
"16:19:56,7491451","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS","Desired Access: Query Value, Enumerate Sub Keys"
"16:19:56,7491595","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\ResourcePolicies","NAME NOT FOUND","Length: 24"
"16:19:56,7491712","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS",""
"16:19:56,7493197","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\WMI\Security\57a6ed1a-79f7-5011-b242-4784e5620cf7","NAME NOT FOUND","Length: 528"
"16:19:56,7493738","median_filter.exe","18224","QueryNameInformationFile","C:\Windows\System32\ntdll.dll","SUCCESS","Name: \Windows\System32\ntdll.dll"
"16:19:56,7494262","median_filter.exe","18224","RegOpenKey","HKLM\SYSTEM\CurrentControlSet\Control\Session Manager","REPARSE","Desired Access: Query Value, Enumerate Sub Keys"
"16:19:56,7494398","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS","Desired Access: Query Value, Enumerate Sub Keys"
"16:19:56,7494542","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\ResourcePolicies","NAME NOT FOUND","Length: 24"
"16:19:56,7494652","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS",""
"16:19:56,7496554","median_filter.exe","18224","CreateFile","C:\Users\kseni\lab2_OS_wind\build","SUCCESS","Desired Access: Execute/Traverse, Synchronize, Disposition: Open, Options: Directory, Synchronous IO Non-Alert, Attributes: n/a, ShareMode: Read, Write, AllocationSize: n/a, OpenResult: Opened"
"16:19:56,7497780","median_filter.exe","18224","Load Image","C:\Windows\System32\kernel32.dll","SUCCESS","Image Base: 0x7ff88d110000, Image Size: 0xc4000"
"16:19:56,7499525","median_filter.exe","18224","Load Image","C:\Windows\System32\KernelBase.dll","SUCCESS","Image Base: 0x7ff88b260000, Image Size: 0x3b7000"
"16:19:56,7513028","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\WMI\Security\3c74afb9-8d82-44e3-b52c-365dbf48382a","NAME NOT FOUND","Length: 528"
"16:19:56,7513517","median_filter.exe","18224","QueryNameInformationFile","C:\Windows\System32\KernelBase.dll","SUCCESS","Name: \Windows\System32\KernelBase.dll"
"16:19:56,7514987","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\WMI\Security\b749553b-d950-5e03-6282-3145a61b1002","NAME NOT FOUND","Length: 528"
"16:19:56,7515260","median_filter.exe","18224","QueryNameInformationFile","C:\Windows\System32\KernelBase.dll","SUCCESS","Name: \Windows\System32\KernelBase.dll"
"16:19:56,7516557","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\StateSeparation\RedirectionMap\Keys","REPARSE","Desired Access: Read"
"16:19:56,7516750","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\StateSeparation\RedirectionMap\Keys","NAME NOT FOUND","Desired Access: Read"
"16:19:56,7517262","median_filter.exe","18224","QueryNameInformationFile","C:\Windows\System32\KernelBase.dll","SUCCESS","Name: \Windows\System32\KernelBase.dll"
"16:19:56,7517469","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\WMI\Security\05f95efe-7f75-49c7-a994-60a55cc09571","NAME NOT FOUND","Length: 528"
"16:19:56,7517703","median_filter.exe","18224","QueryNameInformationFile","C:\Windows\System32\KernelBase.dll","SUCCESS","Name: \Windows\System32\KernelBase.dll"
"16:19:56,7518071","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Terminal Server","REPARSE","Desired Access: Read"
"16:19:56,7518174","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Terminal Server","SUCCESS","Desired Access: Read"
"16:19:56,7518304","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Terminal Server\TSAppCompat","NAME NOT FOUND","Length: 548"
"16:19:56,7518394","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Terminal Server\TSUserEnabled","SUCCESS","Type: REG_DWORD, Length: 4, Data: 0"
"16:19:56,7518519","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Terminal Server","SUCCESS",""
"16:19:56,7519950","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\SafeBoot\Option","REPARSE","Desired Access: Query Value, Set Value"
"16:19:56,7520049","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\SafeBoot\Option","NAME NOT FOUND","Desired Access: Query Value, Set Value"
"16:19:56,7520180","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Srp\GP\DLL","REPARSE","Desired Access: Read"
"16:19:56,7520261","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Srp\GP\DLL","SUCCESS","Desired Access: Read"
"16:19:56,7520373","median_filter.exe","18224","RegQueryKey","HKLM\System\CurrentControlSet\Control\Srp\Gp\DLL","SUCCESS","Query: Full, SubKeys: 1, Values: 0"
"16:19:56,7520476","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Srp\Gp\DLL","SUCCESS",""
"16:19:56,7520557","median_filter.exe","18224","RegOpenKey","HKLM\Software\Policies\Microsoft\Windows\Safer\CodeIdentifiers","SUCCESS","Desired Access: Query Value"
"16:19:56,7520711","median_filter.exe","18224","RegQueryValue","HKLM\SOFTWARE\Policies\Microsoft\Windows\safer\codeidentifiers\TransparentEnabled","NAME NOT FOUND","Length: 80"
"16:19:56,7520804","median_filter.exe","18224","RegCloseKey","HKLM\SOFTWARE\Policies\Microsoft\Windows\safer\codeidentifiers","SUCCESS",""
"16:19:56,7520909","median_filter.exe","18224","RegOpenKey","HKCU\Software\Policies\Microsoft\Windows\Safer\CodeIdentifiers","NAME NOT FOUND","Desired Access: Query Value"
"16:19:56,7521108","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\FileSystem\","REPARSE","Desired Access: Read"
"16:19:56,7521192","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\FileSystem","SUCCESS","Desired Access: Read"
"16:19:56,7521285","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\FileSystem\LongPathsEnabled","SUCCESS","Type: REG_DWORD, Length: 4, Data: 1"
"16:19:56,7521399","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\FileSystem\LPGO","NAME NOT FOUND","Length: 20"
"16:19:56,7521487","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\FileSystem","SUCCESS",""
"16:19:56,7522851","median_filter.exe","18224","Load Image","C:\Windows\System32\msvcrt.dll","SUCCESS","Image Base: 0x7ff88dc20000, Image Size: 0xa7000"
"16:19:56,7524151","median_filter.exe","18224","Thread Create","","SUCCESS","Thread ID: 6692"
"16:19:56,7527255","median_filter.exe","18224","RegOpenKey","HKLM\SYSTEM\CurrentControlSet\Control\Session Manager","REPARSE","Desired Access: Query Value, Enumerate Sub Keys"
"16:19:56,7527405","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS","Desired Access: Query Value, Enumerate Sub Keys"
"16:19:56,7527569","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\ResourcePolicies","NAME NOT FOUND","Length: 24"
"16:19:56,7527854","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS",""
"16:19:56,7528377","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Nls\Sorting\Versions","REPARSE","Desired Access: Read"
"16:19:56,7528560","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Nls\Sorting\Versions","SUCCESS","Desired Access: Read"
"16:19:56,7528762","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Nls\Sorting\Versions\(Default)","SUCCESS","Type: REG_SZ, Length: 18, Data: 00060403"
"16:19:56,7528928","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Nls\Sorting\Versions\000604xx","SUCCESS","Type: REG_SZ, Length: 26, Data: kernel32.dll"
"16:19:56,7529692","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Session Manager","REPARSE","Desired Access: Query Value"
"16:19:56,7529830","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS","Desired Access: Query Value"
"16:19:56,7529975","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\SmtDelaySleepLoopWindowSize","NAME NOT FOUND","Length: 80"
"16:19:56,7530124","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\SmtDelaySpinCountThreshold","NAME NOT FOUND","Length: 80"
"16:19:56,7530234","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\SmtDelayBaseYield","NAME NOT FOUND","Length: 80"
"16:19:56,7530341","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\SmtFactorYield","NAME NOT FOUND","Length: 80"
"16:19:56,7530445","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Control\Session Manager\SmtDelayMaxYield","NAME NOT FOUND","Length: 80"
"16:19:56,7530569","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Session Manager","SUCCESS",""
"16:19:56,7531472","median_filter.exe","18224","QueryNameInformationFile","C:\Users\kseni\lab2_OS_wind\build\median_filter.exe","SUCCESS","Name: \Users\kseni\lab2_OS_wind\build\median_filter.exe"
"16:20:12,5888699","median_filter.exe","18224","Thread Create","","SUCCESS","Thread ID: 16696"
"16:20:12,5889106","median_filter.exe","18224","Thread Create","","SUCCESS","Thread ID: 18896"
"16:20:12,5889387","median_filter.exe","18224","Thread Create","","SUCCESS","Thread ID: 11368"
"16:20:12,5889652","median_filter.exe","18224","Thread Create","","SUCCESS","Thread ID: 17752"
"16:20:26,7586740","median_filter.exe","18224","Thread Exit","","SUCCESS","Thread ID: 6692, User Time: 0.0000000, Kernel Time: 0.0000000"
"16:20:42,6054431","median_filter.exe","18224","Thread Exit","","SUCCESS","Thread ID: 17752, User Time: 0.0000000, Kernel Time: 0.0000000"
"16:20:42,6055270","median_filter.exe","18224","Thread Exit","","SUCCESS","Thread ID: 11368, User Time: 0.0000000, Kernel Time: 0.0000000"
"16:20:42,6058470","median_filter.exe","18224","Thread Exit","","SUCCESS","Thread ID: 18896, User Time: 0.0000000, Kernel Time: 0.0000000"
"16:20:42,6058976","median_filter.exe","18224","Thread Exit","","SUCCESS","Thread ID: 16696, User Time: 0.0000000, Kernel Time: 0.0000000"
"16:20:42,6310641","median_filter.exe","18224","Thread Exit","","SUCCESS","Thread ID: 4944, User Time: 0.0000000, Kernel Time: 0.0000000"
"16:20:42,6313656","median_filter.exe","18224","Process Exit","","SUCCESS","Exit Status: 0, User Time: 0.0000000 seconds, Kernel Time: 0.0000000 seconds, Private Bytes: 675 840, Peak Private Bytes: 851 968, Working Set: 3 637 248, Peak Working Set: 3 641 344"
"16:20:42,6314575","median_filter.exe","18224","RegOpenKey","HKLM\System\CurrentControlSet\Services\bam\State\UserSettings\S-1-5-21-956525231-4267278670-869784965-1001","SUCCESS","Desired Access: All Access"
"16:20:42,6314994","median_filter.exe","18224","RegQueryValue","HKLM\System\CurrentControlSet\Services\bam\State\UserSettings\S-1-5-21-956525231-4267278670-869784965-1001\\Device\HarddiskVolume3\Users\kseni\lab2_OS_wind\build\median_filter.exe","NAME NOT FOUND","Length: 40"
"16:20:42,6315350","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Services\bam\State\UserSettings\S-1-5-21-956525231-4267278670-869784965-1001","SUCCESS",""
"16:20:42,6316232","median_filter.exe","18224","CloseFile","C:\Users\kseni\lab2_OS_wind\build","SUCCESS",""
"16:20:42,6318121","median_filter.exe","18224","RegCloseKey","HKLM\System\CurrentControlSet\Control\Nls\Sorting\Versions","SUCCESS",""
\end{lstlisting}